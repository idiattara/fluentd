# Update Parameters for PutElasticsearchHttpRecord

The script **change_elastic_param.py** is designed to update a specific processor in Apache NiFi. It is primarily used to configure a "PutElasticsearchHttpRecord" processor. The script reads an XML file (***flow.xml***) representing the NiFi flow, searches for the processor to update, makes the necessary changes in its configuration, and restarts the processor.

## Configuration for change_elastic_param.py

Make sure the following environment variables are configured before running the script:

- **nifi_user**: User name for connecting to NiFi.
- **nifi_password**: NiFi user's password.
- **NIFI_HOST**: NiFi server's URL.
Also, ensure you have a "pipeline.txt" file that contains the list of process group names to be processed.

## Operation of change_elastic_param.py
- The script reads the "pipeline.txt" file to obtain the list of process group names to be processed.
- It searches for the "PutElasticsearchHttpRecord" processor in the NiFi flow.
- For each processor found, the script performs the following steps:
- Checks if the processor is already updated, recording the processor's ID in "done.txt".
- Checks if the processor's process group is in the list of authorized groups; otherwise, the script moves on to the next processor.
- Checks if the NiFi cluster is healthy.
- Updates the processor's configuration with Elasticsearch parameters.
- Restarts the processor.
- The script logs errors in "error.txt" and ignored processors in "not_treated.txt."

## Usage of change_elastic_param.py

   ```bash  python change_elastic_param.py flow.xml   ```

# Update Parameters for update_flow_to_dlq.py

The script **update_flow_to_dlq.py** is designed to update a specific flow in Apache NiFi. It is primarily used to configure flows that contain a "PutHDFS" processor. The script reads an XML file (***flow.xml***) representing the NiFi flow, searches for the flows to update, makes the necessary changes in their configuration, and restarts the processor.

## Operation of update_flow_to_dlq.py
The script reads the "pipeline.txt" file to obtain the list of process group names to be processed.

It searches for the "PutHDFS" processor in the NiFi flow.

For each processor found, the script performs the following steps:

- Checks if the processor is already updated, recording the processor's ID in "done.txt".
- Checks if the processor's process group is in the list of authorized groups; otherwise, the script moves on to the next processor.
- Checks if the NiFi cluster is healthy.
- Stops the flow and changes the merge configuration to force data ingestion.
- Instantiates a predefined NiFi template.
- Updates the template's configuration based on the flow parameters you want to update.
- Restarts the processor.
- Removes the old flow.
- The script logs errors in "error.txt" and ignored processors in "not_treated.txt."

## Usage of update_flow_to_dlq.py

   ```bash  python update_flow_to_dlq.py flow.xml   ```
